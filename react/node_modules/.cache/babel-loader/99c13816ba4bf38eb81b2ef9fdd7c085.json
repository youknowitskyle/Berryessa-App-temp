{"ast":null,"code":"import _objectSpread from \"/Users/kyle/workspace/Projects/Berryessa-App/react/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/kyle/workspace/Projects/Berryessa-App/react/src/components/Admin/index.js\";\nimport React, { Component } from \"react\";\nimport { Switch, Route, Link } from \"react-router-dom\";\nimport { compose } from \"recompose\";\nimport Popup from \"reactjs-popup\";\nimport { withFirebase } from \"../Firebase\";\nimport { withAuthorization } from \"../Session\";\nimport * as ROLES from \"../../constants/roles\";\nimport * as ROUTES from \"../../constants/routes\";\n\nconst AdminPage = () => React.createElement(\"div\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 12\n  },\n  __self: this\n}, React.createElement(\"h1\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 13\n  },\n  __self: this\n}, \"Admin\"), React.createElement(\"p\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 14\n  },\n  __self: this\n}, \"The Admin Page is accessible by every signed in admin user.\"), React.createElement(Switch, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 16\n  },\n  __self: this\n}, React.createElement(Route, {\n  exact: true,\n  path: ROUTES.ADMIN_DETAILS,\n  component: UserItem,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 17\n  },\n  __self: this\n}), React.createElement(Route, {\n  exact: true,\n  path: ROUTES.ADMIN,\n  component: UserList,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 18\n  },\n  __self: this\n})));\n\nclass UserListBase extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: false,\n      users: []\n    };\n  }\n\n  componentDidMount() {\n    this.setState({\n      loading: true\n    });\n    this.props.firebase.users().on(\"value\", snapshot => {\n      const usersObject = snapshot.val();\n      const usersList = Object.keys(usersObject).map(key => _objectSpread({}, usersObject[key], {\n        uid: key\n      }));\n      this.setState({\n        users: usersList,\n        loading: false\n      });\n    });\n  }\n\n  componentWillUnmount() {\n    this.props.firebase.users().off();\n  }\n\n  render() {\n    const _this$state = this.state,\n          users = _this$state.users,\n          loading = _this$state.loading;\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60\n      },\n      __self: this\n    }, \"Users\"), loading && React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61\n      },\n      __self: this\n    }, \"Loading...\"), React.createElement(\"ul\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63\n      },\n      __self: this\n    }, users.map(user => React.createElement(\"li\", {\n      key: user.uid,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66\n      },\n      __self: this\n    }, React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }, \"ID:\"), \" \", user.uid), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69\n      },\n      __self: this\n    }, React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70\n      },\n      __self: this\n    }, \" | E-Mail:\"), \" \", user.email), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }, React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73\n      },\n      __self: this\n    }, \" | Username:\"), \" \", user.username), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }, React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, \" | Approved: \"), \" \", user.roles.APPROVED ? React.createElement(\"span\", {\n      style: {\n        color: \"green\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, \"TRUE\") : React.createElement(\"span\", {\n      style: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }, \"FALSE\")), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }, React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, \" | Parent: \"), \" \", user.roles.PARENT ? React.createElement(\"span\", {\n      style: {\n        color: \"green\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }, \"TRUE\") : React.createElement(\"span\", {\n      style: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, \"FALSE\")), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: {\n        pathname: \"\".concat(ROUTES.ADMIN, \"/\").concat(user.uid),\n        state: {\n          user\n        }\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, \" \", \"Details\"))))));\n  }\n\n}\n\nclass UserItemBase extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onSendPasswordResetEmail = () => {\n      this.props.firebase.doPasswordReset(this.state.user.email);\n      this.setState({\n        sentReset: true\n      });\n    };\n\n    this.onBanUser = () => {\n      this.props.firebase.db.ref(\"users/\".concat(this.props.match.params.id, \"/roles/\")).set({\n        BANNED: \"BANNED\"\n      });\n      this.setState({\n        banned: true\n      });\n    };\n\n    this.onApproveUser = () => {\n      this.props.firebase.db.ref(\"users/\".concat(this.props.match.params.id, \"/roles/\")).update({\n        APPROVED: \"APPROVED\"\n      });\n      this.setState({\n        approved: true\n      });\n    };\n\n    this.state = _objectSpread({\n      loading: false,\n      user: null,\n      sentReset: false,\n      approved: false,\n      banned: false\n    }, props.location.state);\n  }\n\n  componentDidMount() {\n    console.log(\"hello\");\n\n    if (this.state.user) {\n      this.setState({\n        approved: this.state.user.roles.APPROVED,\n        banned: this.state.user.roles.BANNED\n      });\n      return;\n    }\n\n    this.setState({\n      loading: true\n    });\n    this.props.firebase.user(this.props.match.params.id).on(\"value\", snapshot => {\n      this.setState({\n        user: snapshot.val(),\n        loading: false,\n        approved: snapshot.val().roles.APPROVED,\n        banned: snapshot.val().roles.BANNED\n      });\n    });\n    this.setState({\n      approved: this.state.user.roles.APPROVED,\n      banned: this.state.user.roles.BANNED\n    });\n  }\n\n  componentWillUnmount() {\n    this.props.firebase.user(this.props.match.params.id).off();\n  }\n\n  render() {\n    const _this$state2 = this.state,\n          user = _this$state2.user,\n          loading = _this$state2.loading;\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, \"User (\", this.props.match.params.id, \")\"), loading && React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, \"Loading ...\"), user && React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, \"ID: \"), \" \", this.props.match.params.id), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }, \" | E-Mail:\"), \" \", user.email), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }, React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, \" | Username:\"), \" \", user.username), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, !this.state.approved && React.createElement(\"button\", {\n      type: \"button\",\n      onClick: this.onApproveUser,\n      style: {\n        backgroundColor: \"green\",\n        color: \"white\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }, \"Approve User\")), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    }, !this.state.approved && React.createElement(\"button\", {\n      type: \"button\",\n      onClick: this.onBanUser,\n      style: {\n        backgroundColor: \"red\",\n        color: \"white\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }, \"Ban User\")), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      type: \"button\",\n      onClick: this.onSendPasswordResetEmail,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    }, \"Send Password Reset\"), this.state.sentReset && React.createElement(\"div\", {\n      style: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229\n      },\n      __self: this\n    }, \"Password reset sent\")), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232\n      },\n      __self: this\n    }, React.createElement(Popup, {\n      trigger: React.createElement(\"button\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      }, \"Ban User\"),\n      modal: true,\n      closeOnDocumentClick: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238\n      },\n      __self: this\n    }, \"Are you sure you would like to ban this user? This action is irreversible.\"), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      type: \"button\",\n      onClick: this.onBanUser,\n      style: {\n        backgroundColor: \"red\",\n        color: \"white\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243\n      },\n      __self: this\n    }, \"Ban User\"))))));\n  }\n\n}\n\nconst condition = authUser => authUser && !!authUser.roles[ROLES.ADMIN];\n\nconst UserList = withFirebase(UserListBase);\nconst UserItem = withFirebase(UserItemBase);\n/*const UserItem = ({ match }) => (\n  <div>\n    <h2>User ({match.params.id})</h2>\n  </div>\n);*/\n\nexport default compose(withAuthorization(condition), withFirebase)(AdminPage);","map":{"version":3,"sources":["/Users/kyle/workspace/Projects/Berryessa-App/react/src/components/Admin/index.js"],"names":["React","Component","Switch","Route","Link","compose","Popup","withFirebase","withAuthorization","ROLES","ROUTES","AdminPage","ADMIN_DETAILS","UserItem","ADMIN","UserList","UserListBase","constructor","props","state","loading","users","componentDidMount","setState","firebase","on","snapshot","usersObject","val","usersList","Object","keys","map","key","uid","componentWillUnmount","off","render","user","email","username","roles","APPROVED","color","PARENT","pathname","UserItemBase","onSendPasswordResetEmail","doPasswordReset","sentReset","onBanUser","db","ref","match","params","id","set","BANNED","banned","onApproveUser","update","approved","location","console","log","backgroundColor","condition","authUser"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Switch, Route, Link } from \"react-router-dom\";\nimport { compose } from \"recompose\";\nimport Popup from \"reactjs-popup\";\n\nimport { withFirebase } from \"../Firebase\";\nimport { withAuthorization } from \"../Session\";\nimport * as ROLES from \"../../constants/roles\";\nimport * as ROUTES from \"../../constants/routes\";\n\nconst AdminPage = () => (\n  <div>\n    <h1>Admin</h1>\n    <p>The Admin Page is accessible by every signed in admin user.</p>\n\n    <Switch>\n      <Route exact path={ROUTES.ADMIN_DETAILS} component={UserItem} />\n      <Route exact path={ROUTES.ADMIN} component={UserList} />\n    </Switch>\n  </div>\n);\n\nclass UserListBase extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      loading: false,\n      users: []\n    };\n  }\n\n  componentDidMount() {\n    this.setState({ loading: true });\n\n    this.props.firebase.users().on(\"value\", snapshot => {\n      const usersObject = snapshot.val();\n\n      const usersList = Object.keys(usersObject).map(key => ({\n        ...usersObject[key],\n        uid: key\n      }));\n\n      this.setState({\n        users: usersList,\n        loading: false\n      });\n    });\n  }\n\n  componentWillUnmount() {\n    this.props.firebase.users().off();\n  }\n\n  render() {\n    const { users, loading } = this.state;\n\n    return (\n      <div>\n        <h2>Users</h2>\n        {loading && <div>Loading...</div>}\n\n        <ul>\n          {users.map(user => (\n            <li key={user.uid}>\n              <span>\n                <strong>ID:</strong> {user.uid}\n              </span>\n              <span>\n                <strong> | E-Mail:</strong> {user.email}\n              </span>\n              <span>\n                <strong> | Username:</strong> {user.username}\n              </span>\n              <span>\n                <strong> | Approved: </strong>{\" \"}\n                {user.roles.APPROVED ? (\n                  <span style={{ color: \"green\" }}>TRUE</span>\n                ) : (\n                  <span style={{ color: \"red\" }}>FALSE</span>\n                )}\n              </span>\n              <span>\n                <strong> | Parent: </strong>{\" \"}\n                {user.roles.PARENT ? (\n                  <span style={{ color: \"green\" }}>TRUE</span>\n                ) : (\n                  <span style={{ color: \"red\" }}>FALSE</span>\n                )}\n              </span>\n              <span>\n                <Link\n                  to={{\n                    pathname: `${ROUTES.ADMIN}/${user.uid}`,\n                    state: { user }\n                  }}\n                >\n                  {\" \"}\n                  Details\n                </Link>\n              </span>\n            </li>\n          ))}\n        </ul>\n      </div>\n    );\n  }\n}\n\nclass UserItemBase extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      loading: false,\n      user: null,\n      sentReset: false,\n      approved: false,\n      banned: false,\n      ...props.location.state\n    };\n  }\n\n  componentDidMount() {\n    console.log(\"hello\");\n\n    if (this.state.user) {\n      this.setState({\n        approved: this.state.user.roles.APPROVED,\n        banned: this.state.user.roles.BANNED\n      });\n      return;\n    }\n\n    this.setState({ loading: true });\n\n    this.props.firebase\n      .user(this.props.match.params.id)\n      .on(\"value\", snapshot => {\n        this.setState({\n          user: snapshot.val(),\n          loading: false,\n          approved: snapshot.val().roles.APPROVED,\n          banned: snapshot.val().roles.BANNED\n        });\n      });\n\n    this.setState({\n      approved: this.state.user.roles.APPROVED,\n      banned: this.state.user.roles.BANNED\n    });\n  }\n\n  componentWillUnmount() {\n    this.props.firebase.user(this.props.match.params.id).off();\n  }\n\n  onSendPasswordResetEmail = () => {\n    this.props.firebase.doPasswordReset(this.state.user.email);\n    this.setState({\n      sentReset: true\n    });\n  };\n\n  onBanUser = () => {\n    this.props.firebase.db\n      .ref(`users/${this.props.match.params.id}/roles/`)\n      .set({ BANNED: \"BANNED\" });\n\n    this.setState({ banned: true });\n  };\n\n  onApproveUser = () => {\n    this.props.firebase.db\n      .ref(`users/${this.props.match.params.id}/roles/`)\n      .update({ APPROVED: \"APPROVED\" });\n\n    this.setState({\n      approved: true\n    });\n  };\n\n  render() {\n    const { user, loading } = this.state;\n\n    return (\n      <div>\n        <h2>User ({this.props.match.params.id})</h2>\n        {loading && <div>Loading ...</div>}\n\n        {user && (\n          <div>\n            <span>\n              <strong>ID: </strong> {this.props.match.params.id}\n            </span>\n            <span>\n              <strong> | E-Mail:</strong> {user.email}\n            </span>\n            <span>\n              <strong> | Username:</strong> {user.username}\n            </span>\n            <span>\n              {!this.state.approved && (\n                <button\n                  type=\"button\"\n                  onClick={this.onApproveUser}\n                  style={{ backgroundColor: \"green\", color: \"white\" }}\n                >\n                  Approve User\n                </button>\n              )}\n            </span>\n            <span>\n              {!this.state.approved && (\n                <button\n                  type=\"button\"\n                  onClick={this.onBanUser}\n                  style={{ backgroundColor: \"red\", color: \"white\" }}\n                >\n                  Ban User\n                </button>\n              )}\n            </span>\n            <span>\n              <button type=\"button\" onClick={this.onSendPasswordResetEmail}>\n                Send Password Reset\n              </button>\n              {this.state.sentReset && (\n                <div style={{ color: \"red\" }}>Password reset sent</div>\n              )}\n            </span>\n            <span>\n              <Popup\n                trigger={<button>Ban User</button>}\n                modal\n                closeOnDocumentClick\n              >\n                <div>\n                  Are you sure you would like to ban this user? This action is\n                  irreversible.\n                </div>\n                <div>\n                  <button\n                    type=\"button\"\n                    onClick={this.onBanUser}\n                    style={{ backgroundColor: \"red\", color: \"white\" }}\n                  >\n                    Ban User\n                  </button>\n                </div>\n              </Popup>\n            </span>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nconst condition = authUser => authUser && !!authUser.roles[ROLES.ADMIN];\n\nconst UserList = withFirebase(UserListBase);\nconst UserItem = withFirebase(UserItemBase);\n\n/*const UserItem = ({ match }) => (\n  <div>\n    <h2>User ({match.params.id})</h2>\n  </div>\n);*/\n\nexport default compose(\n  withAuthorization(condition),\n  withFirebase\n)(AdminPage);\n"]},"metadata":{},"sourceType":"module"}