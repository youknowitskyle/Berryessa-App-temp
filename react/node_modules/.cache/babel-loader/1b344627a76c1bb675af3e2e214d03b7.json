{"ast":null,"code":"import _objectSpread from \"/Users/kyle/workspace/Projects/Berryessa-App/react/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _objectWithoutProperties from \"/Users/kyle/workspace/Projects/Berryessa-App/react/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _jsxFileName = \"/Users/kyle/workspace/Projects/Berryessa-App/react/src/components/Moderator/index.js\";\nimport React, { Component } from \"react\";\nimport { Switch, Route, Link } from \"react-router-dom\";\nimport { compose } from \"recompose\";\nimport DatePicker from \"react-datepicker\";\nimport { withFirebase } from \"../Firebase\";\nimport { AuthUserContext, withAuthorization, withEmailVerification } from \"../Session\";\nimport * as ROLES from \"../../constants/roles\";\nimport * as ROUTES from \"../../constants/routes\";\nimport \"react-datepicker/dist/react-datepicker.css\";\n\nconst ModeratorPage = () => React.createElement(\"div\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 17\n  },\n  __self: this\n}, React.createElement(\"h1\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 18\n  },\n  __self: this\n}, \"Moderator\"), React.createElement(\"p\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 19\n  },\n  __self: this\n}, \"The Moderator Page is accessible by every signed in moderator user.\"), React.createElement(\"h2\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 21\n  },\n  __self: this\n}, \"Announcements\"), React.createElement(Announcements, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 22\n  },\n  __self: this\n}), React.createElement(Example, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 23\n  },\n  __self: this\n}));\n\nclass Example extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      startDate: new Date()\n    };\n\n    this.handleChange = date => {\n      this.setState({\n        startDate: date\n      });\n    };\n  }\n\n  render() {\n    return React.createElement(DatePicker, {\n      selected: this.state.startDate,\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40\n      },\n      __self: this\n    });\n  }\n\n}\n\nclass AnnouncementsBase extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onChangeText = event => {\n      this.setState({\n        text: event.target.value\n      });\n    };\n\n    this.onChangeTitle = event => {\n      this.setState({\n        title: event.target.value\n      });\n    };\n\n    this.handleDateChange = date => {\n      this.setState({\n        endDate: date\n      });\n    };\n\n    this.onCreateAnnouncement = (event, authUser) => {\n      const dateHolder = Date.parse(this.state.endDate);\n      this.props.firebase.announcements().push({\n        title: this.state.title,\n        text: this.state.text,\n        endDate: dateHolder,\n        userId: authUser.uid,\n        createdAt: this.props.firebase.serverValue.TIMESTAMP,\n        username: authUser.username\n      });\n      this.setState({\n        title: \"\",\n        text: \"\",\n        endDate: \"\"\n      });\n      event.preventDefault();\n    };\n\n    this.onRemoveAnnouncement = uid => {\n      this.props.firebase.announcement(uid).remove();\n    };\n\n    this.onEditAnnouncement = (announcement, title, text, dateHolder) => {\n      const uid = announcement.uid,\n            announcementSnapshot = _objectWithoutProperties(announcement, [\"uid\"]);\n\n      const endDate = Date.parse(dateHolder);\n      this.props.firebase.announcement(announcement.uid).set(_objectSpread({}, announcementSnapshot, {\n        title,\n        text,\n        endDate,\n        editedAt: this.props.firebase.serverValue.TIMESTAMP\n      }));\n    };\n\n    this.state = {\n      title: \"\",\n      text: \"\",\n      endDate: \"\",\n      loading: false,\n      announcement: [],\n      error: false\n    };\n  }\n\n  componentDidMount() {\n    this.setState({\n      loading: true\n    });\n    this.props.firebase.announcements().on(\"value\", snapshot => {\n      const announcementObject = snapshot.val();\n\n      if (announcementObject) {\n        const announcementList = Object.keys(announcementObject).map(key => _objectSpread({}, announcementObject[key], {\n          uid: key\n        }));\n        announcementList.forEach(item => {\n          console.log(item.endDate);\n        });\n        const filteredAnnouncements = announcementList.filter(item => {\n          return parseInt(item.endDate) > Date.now();\n        });\n        this.setState({\n          announcements: filteredAnnouncements,\n          loading: false\n        });\n      } else {\n        this.setState({\n          announcements: null,\n          loading: false\n        });\n      }\n\n      this.setState({\n        loading: false\n      });\n    });\n  }\n\n  componentWillUnmount() {\n    this.props.firebase.announcements().off();\n  }\n\n  render() {\n    const _this$state = this.state,\n          title = _this$state.title,\n          text = _this$state.text,\n          endDate = _this$state.endDate,\n          announcements = _this$state.announcements,\n          loading = _this$state.loading;\n    return React.createElement(AuthUserContext.Consumer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, authUser => React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, loading && React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, \"Loading ...\"), announcements ? React.createElement(AnnouncementList, {\n      authUser: authUser,\n      announcements: announcements,\n      onEditAnnouncement: this.onEditAnnouncement,\n      onRemoveAnnouncement: this.onRemoveAnnouncement,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }) : React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, \"There are no announcements...\"), React.createElement(\"form\", {\n      onSubmit: event => this.onCreateAnnouncement(event, authUser),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      value: title,\n      placeholder: \"Title\",\n      onChange: this.onChangeTitle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      type: \"text\",\n      value: text,\n      placeholder: \"Body\",\n      onChange: this.onChangeText,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }), React.createElement(DatePicker, {\n      selected: this.state.endDate,\n      onSelect: this.handleDateChange,\n      onChange: this.handleDateChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, \"Send\"), this.state.error && React.createElement(\"h2\", {\n      syle: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, \"Please enter a valid date.\"))));\n  }\n\n}\n\nconst AnnouncementList = ({\n  authUser,\n  announcements,\n  onRemoveAnnouncement,\n  onEditAnnouncement\n}) => React.createElement(\"ul\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 198\n  },\n  __self: this\n}, announcements.map(announcement => React.createElement(AnnouncementItem, {\n  authUser: authUser,\n  key: announcement.uid,\n  announcement: announcement,\n  onEditAnnouncement: onEditAnnouncement,\n  onRemoveAnnouncement: onRemoveAnnouncement,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 200\n  },\n  __self: this\n})));\n\nclass AnnouncementItem extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onToggleEditMode = () => {\n      this.setState(state => ({\n        editMode: !state.editMode,\n        editTitle: this.props.announcement.title,\n        editText: this.props.announcement.text,\n        editDate: this.props.announcement.endDate\n      }));\n    };\n\n    this.onChangeEditText = event => {\n      this.setState({\n        editText: event.target.value\n      });\n    };\n\n    this.onChangeEditTitle = event => {\n      this.setState({\n        editTitle: event.target.value\n      });\n    };\n\n    this.onChangeDate = event => {\n      this.setState({\n        editDate: event\n      });\n    };\n\n    this.onSaveEditText = () => {\n      this.props.onEditAnnouncement(this.props.announcement, this.state.editTitle, this.state.editText, this.state.editDate);\n      this.setState({\n        editMode: false\n      });\n    };\n\n    this.state = {\n      editMode: false,\n      editTitle: this.props.announcement.title,\n      editText: this.props.announcement.text,\n      editDate: this.props.announcement.endDate\n    };\n  }\n\n  render() {\n    const _this$props = this.props,\n          authUser = _this$props.authUser,\n          announcement = _this$props.announcement,\n          onRemoveAnnouncement = _this$props.onRemoveAnnouncement;\n    const _this$state2 = this.state,\n          editMode = _this$state2.editMode,\n          editTitle = _this$state2.editTitle,\n          editText = _this$state2.editText;\n    return React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260\n      },\n      __self: this\n    }, editMode ? React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      value: editTitle,\n      onChange: this.onChangeEditTitle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      type: \"text\",\n      value: editText,\n      onChange: this.onChangeEditText,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 268\n      },\n      __self: this\n    }), React.createElement(DatePicker, {\n      selected: this.state.endDate,\n      onSelect: this.onChangeDate,\n      onChange: this.onChangeDate,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273\n      },\n      __self: this\n    })) : React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280\n      },\n      __self: this\n    }, React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281\n      },\n      __self: this\n    }, announcement.title), \" \", announcement.text, \" (Posted by\", \" \", announcement.username, \")\", announcement.editedAt && React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 283\n      },\n      __self: this\n    }, \" (Edited) \")), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 286\n      },\n      __self: this\n    }, editMode ? React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      onClick: this.onSaveEditText,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289\n      },\n      __self: this\n    }, \"Save\"), React.createElement(\"button\", {\n      onClick: this.onToggleEditMode,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290\n      },\n      __self: this\n    }, \"Cancel\")) : React.createElement(\"button\", {\n      onClick: this.onToggleEditMode,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    }, \"Edit\"), !editMode && React.createElement(\"button\", {\n      type: \"button\",\n      onClick: () => onRemoveAnnouncement(announcement.uid),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297\n      },\n      __self: this\n    }, \"Delete\")));\n  }\n\n}\n\nconst Announcements = withFirebase(AnnouncementsBase);\n\nconst condition = authUser => authUser && (!!authUser.roles[ROLES.MODERATOR] || !!authUser.roles[ROLES.ADMIN]);\n\nexport default compose(withAuthorization(condition), withFirebase)(ModeratorPage);","map":{"version":3,"sources":["/Users/kyle/workspace/Projects/Berryessa-App/react/src/components/Moderator/index.js"],"names":["React","Component","Switch","Route","Link","compose","DatePicker","withFirebase","AuthUserContext","withAuthorization","withEmailVerification","ROLES","ROUTES","ModeratorPage","Example","state","startDate","Date","handleChange","date","setState","render","AnnouncementsBase","constructor","props","onChangeText","event","text","target","value","onChangeTitle","title","handleDateChange","endDate","onCreateAnnouncement","authUser","dateHolder","parse","firebase","announcements","push","userId","uid","createdAt","serverValue","TIMESTAMP","username","preventDefault","onRemoveAnnouncement","announcement","remove","onEditAnnouncement","announcementSnapshot","set","editedAt","loading","error","componentDidMount","on","snapshot","announcementObject","val","announcementList","Object","keys","map","key","forEach","item","console","log","filteredAnnouncements","filter","parseInt","now","componentWillUnmount","off","color","AnnouncementList","AnnouncementItem","onToggleEditMode","editMode","editTitle","editText","editDate","onChangeEditText","onChangeEditTitle","onChangeDate","onSaveEditText","Announcements","condition","roles","MODERATOR","ADMIN"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Switch, Route, Link } from \"react-router-dom\";\nimport { compose } from \"recompose\";\nimport DatePicker from \"react-datepicker\";\n\nimport { withFirebase } from \"../Firebase\";\nimport {\n  AuthUserContext,\n  withAuthorization,\n  withEmailVerification\n} from \"../Session\";\nimport * as ROLES from \"../../constants/roles\";\nimport * as ROUTES from \"../../constants/routes\";\nimport \"react-datepicker/dist/react-datepicker.css\";\n\nconst ModeratorPage = () => (\n  <div>\n    <h1>Moderator</h1>\n    <p>The Moderator Page is accessible by every signed in moderator user.</p>\n\n    <h2>Announcements</h2>\n    <Announcements />\n    <Example />\n  </div>\n);\n\nclass Example extends Component {\n  state = {\n    startDate: new Date()\n  };\n\n  handleChange = date => {\n    this.setState({\n      startDate: date\n    });\n  };\n\n  render() {\n    return (\n      <DatePicker\n        selected={this.state.startDate}\n        onChange={this.handleChange}\n      />\n    );\n  }\n}\n\nclass AnnouncementsBase extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      title: \"\",\n      text: \"\",\n      endDate: \"\",\n      loading: false,\n      announcement: [],\n      error: false\n    };\n  }\n\n  onChangeText = event => {\n    this.setState({ text: event.target.value });\n  };\n\n  onChangeTitle = event => {\n    this.setState({ title: event.target.value });\n  };\n\n  handleDateChange = date => {\n    this.setState({ endDate: date });\n  };\n\n  onCreateAnnouncement = (event, authUser) => {\n    const dateHolder = Date.parse(this.state.endDate);\n\n    this.props.firebase.announcements().push({\n      title: this.state.title,\n      text: this.state.text,\n      endDate: dateHolder,\n      userId: authUser.uid,\n      createdAt: this.props.firebase.serverValue.TIMESTAMP,\n      username: authUser.username\n    });\n    this.setState({ title: \"\", text: \"\", endDate: \"\" });\n\n    event.preventDefault();\n  };\n\n  componentDidMount() {\n    this.setState({ loading: true });\n\n    this.props.firebase.announcements().on(\"value\", snapshot => {\n      const announcementObject = snapshot.val();\n\n      if (announcementObject) {\n        const announcementList = Object.keys(announcementObject).map(key => ({\n          ...announcementObject[key],\n          uid: key\n        }));\n        announcementList.forEach(item => {\n          console.log(item.endDate);\n        });\n        const filteredAnnouncements = announcementList.filter(item => {\n          return parseInt(item.endDate) > Date.now();\n        });\n        this.setState({\n          announcements: filteredAnnouncements,\n          loading: false\n        });\n      } else {\n        this.setState({ announcements: null, loading: false });\n      }\n\n      this.setState({ loading: false });\n    });\n  }\n\n  componentWillUnmount() {\n    this.props.firebase.announcements().off();\n  }\n\n  onRemoveAnnouncement = uid => {\n    this.props.firebase.announcement(uid).remove();\n  };\n\n  onEditAnnouncement = (announcement, title, text, dateHolder) => {\n    const { uid, ...announcementSnapshot } = announcement;\n    const endDate = Date.parse(dateHolder);\n\n    this.props.firebase.announcement(announcement.uid).set({\n      ...announcementSnapshot,\n      title,\n      text,\n      endDate,\n      editedAt: this.props.firebase.serverValue.TIMESTAMP\n    });\n  };\n\n  render() {\n    const { title, text, endDate, announcements, loading } = this.state;\n\n    return (\n      <AuthUserContext.Consumer>\n        {authUser => (\n          <div>\n            {loading && <div>Loading ...</div>}\n\n            {announcements ? (\n              <AnnouncementList\n                authUser={authUser}\n                announcements={announcements}\n                onEditAnnouncement={this.onEditAnnouncement}\n                onRemoveAnnouncement={this.onRemoveAnnouncement}\n              />\n            ) : (\n              <div>There are no announcements...</div>\n            )}\n\n            <form\n              onSubmit={event => this.onCreateAnnouncement(event, authUser)}\n            >\n              <input\n                type=\"text\"\n                value={title}\n                placeholder=\"Title\"\n                onChange={this.onChangeTitle}\n              />\n              <input\n                type=\"text\"\n                value={text}\n                placeholder=\"Body\"\n                onChange={this.onChangeText}\n              />\n              <DatePicker\n                selected={this.state.endDate}\n                onSelect={this.handleDateChange}\n                onChange={this.handleDateChange}\n              />\n              <button type=\"submit\">Send</button>\n              {this.state.error && (\n                <h2 syle={{ color: \"red\" }}>Please enter a valid date.</h2>\n              )}\n            </form>\n          </div>\n        )}\n      </AuthUserContext.Consumer>\n    );\n  }\n}\n\nconst AnnouncementList = ({\n  authUser,\n  announcements,\n  onRemoveAnnouncement,\n  onEditAnnouncement\n}) => (\n  <ul>\n    {announcements.map(announcement => (\n      <AnnouncementItem\n        authUser={authUser}\n        key={announcement.uid}\n        announcement={announcement}\n        onEditAnnouncement={onEditAnnouncement}\n        onRemoveAnnouncement={onRemoveAnnouncement}\n      />\n    ))}\n  </ul>\n);\n\nclass AnnouncementItem extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      editMode: false,\n      editTitle: this.props.announcement.title,\n      editText: this.props.announcement.text,\n      editDate: this.props.announcement.endDate\n    };\n  }\n\n  onToggleEditMode = () => {\n    this.setState(state => ({\n      editMode: !state.editMode,\n      editTitle: this.props.announcement.title,\n      editText: this.props.announcement.text,\n      editDate: this.props.announcement.endDate\n    }));\n  };\n\n  onChangeEditText = event => {\n    this.setState({ editText: event.target.value });\n  };\n\n  onChangeEditTitle = event => {\n    this.setState({ editTitle: event.target.value });\n  };\n\n  onChangeDate = event => {\n    this.setState({ editDate: event });\n  };\n\n  onSaveEditText = () => {\n    this.props.onEditAnnouncement(\n      this.props.announcement,\n      this.state.editTitle,\n      this.state.editText,\n      this.state.editDate\n    );\n\n    this.setState({ editMode: false });\n  };\n\n  render() {\n    const { authUser, announcement, onRemoveAnnouncement } = this.props;\n    const { editMode, editTitle, editText } = this.state;\n\n    return (\n      <li>\n        {editMode ? (\n          <React.Fragment>\n            <input\n              type=\"text\"\n              value={editTitle}\n              onChange={this.onChangeEditTitle}\n            />\n            <input\n              type=\"text\"\n              value={editText}\n              onChange={this.onChangeEditText}\n            />\n            <DatePicker\n              selected={this.state.endDate}\n              onSelect={this.onChangeDate}\n              onChange={this.onChangeDate}\n            />\n          </React.Fragment>\n        ) : (\n          <span>\n            <strong>{announcement.title}</strong> {announcement.text} (Posted by{\" \"}\n            {announcement.username})\n            {announcement.editedAt && <span> (Edited) </span>}\n          </span>\n        )}\n        <span>\n          {editMode ? (\n            <span>\n              <button onClick={this.onSaveEditText}>Save</button>\n              <button onClick={this.onToggleEditMode}>Cancel</button>\n            </span>\n          ) : (\n            <button onClick={this.onToggleEditMode}>Edit</button>\n          )}\n\n          {!editMode && (\n            <button\n              type=\"button\"\n              onClick={() => onRemoveAnnouncement(announcement.uid)}\n            >\n              Delete\n            </button>\n          )}\n        </span>\n      </li>\n    );\n  }\n}\n\nconst Announcements = withFirebase(AnnouncementsBase);\n\nconst condition = authUser =>\n  authUser &&\n  (!!authUser.roles[ROLES.MODERATOR] || !!authUser.roles[ROLES.ADMIN]);\n\nexport default compose(\n  withAuthorization(condition),\n  withFirebase\n)(ModeratorPage);\n"]},"metadata":{},"sourceType":"module"}