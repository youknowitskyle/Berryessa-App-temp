{"ast":null,"code":"import _defineProperty from \"C:\\\\Users\\\\moonl\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\react-scripts\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"C:\\\\Users\\\\moonl\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\react-scripts\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectWithoutProperties\";\nvar _jsxFileName = \"C:\\\\Users\\\\moonl\\\\Documents\\\\GitHub\\\\Berryessa-App\\\\react\\\\src\\\\components\\\\Moderator\\\\index.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from \"react\";\nimport { Switch, Route, Link } from \"react-router-dom\";\nimport { compose } from \"recompose\";\nimport DatePicker from \"react-datepicker\";\nimport { withFirebase } from \"../Firebase\";\nimport { AuthUserContext, withAuthorization, withEmailVerification } from \"../Session\";\nimport * as ROLES from \"../../constants/roles\";\nimport * as ROUTES from \"../../constants/routes\";\nimport \"react-datepicker/dist/react-datepicker.css\";\n\nconst ModeratorPage = () => React.createElement(\"div\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 17\n  },\n  __self: this\n}, React.createElement(\"h1\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 18\n  },\n  __self: this\n}, \"Moderator\"), React.createElement(\"p\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 19\n  },\n  __self: this\n}, \"The Moderator Page is accessible by every signed in moderator user.\"), React.createElement(\"h2\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 21\n  },\n  __self: this\n}, \"Announcements\"), React.createElement(Announcements, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 22\n  },\n  __self: this\n}));\n\nclass AnnouncementsBase extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onChangeText = event => {\n      this.setState({\n        text: event.target.value\n      });\n    };\n\n    this.onChangeTitle = event => {\n      this.setState({\n        title: event.target.value\n      });\n    };\n\n    this.handleDateChange = date => {\n      if (Date.parse(date) > Date.now()) {\n        this.setState({\n          endDate: date,\n          error: false\n        });\n      } else {\n        this.setState({\n          error: true\n        });\n      }\n    };\n\n    this.onCreateAnnouncement = (event, authUser) => {\n      const dateHolder = Date.parse(this.state.endDate);\n      this.props.firebase.announcements().push({\n        title: this.state.title,\n        text: this.state.text,\n        endDate: dateHolder,\n        userId: authUser.uid,\n        createdAt: this.props.firebase.serverValue.TIMESTAMP,\n        username: authUser.username\n      });\n      this.setState({\n        title: \"\",\n        text: \"\",\n        endDate: \"\"\n      });\n      event.preventDefault();\n    };\n\n    this.onRemoveAnnouncement = uid => {\n      this.props.firebase.announcement(uid).remove();\n    };\n\n    this.onEditAnnouncement = (announcement, title, text, dateHolder) => {\n      const uid = announcement.uid,\n            announcementSnapshot = _objectWithoutProperties(announcement, [\"uid\"]);\n\n      const endDate = Date.parse(dateHolder);\n      this.props.firebase.announcement(announcement.uid).set(_objectSpread({}, announcementSnapshot, {\n        title,\n        text,\n        endDate,\n        editedAt: this.props.firebase.serverValue.TIMESTAMP\n      }));\n    };\n\n    this.state = {\n      title: \"\",\n      text: \"\",\n      endDate: \"\",\n      loading: false,\n      announcement: [],\n      error: false\n    };\n  }\n\n  componentDidMount() {\n    this.setState({\n      loading: true\n    });\n    this.props.firebase.announcements().on(\"value\", snapshot => {\n      const announcementObject = snapshot.val();\n\n      if (announcementObject) {\n        const announcementList = Object.keys(announcementObject).map(key => _objectSpread({}, announcementObject[key], {\n          uid: key\n        }));\n        const filteredAnnouncements = announcementList.filter(item => {\n          return parseInt(item.endDate) > Date.now();\n        });\n        this.setState({\n          announcements: filteredAnnouncements,\n          loading: false\n        });\n      } else {\n        this.setState({\n          announcements: null,\n          loading: false\n        });\n      }\n\n      this.setState({\n        loading: false\n      });\n    });\n  }\n\n  componentWillUnmount() {\n    this.props.firebase.announcements().off();\n  }\n\n  render() {\n    const _this$state = this.state,\n          title = _this$state.title,\n          text = _this$state.text,\n          endDate = _this$state.endDate,\n          announcements = _this$state.announcements,\n          loading = _this$state.loading;\n    return React.createElement(AuthUserContext.Consumer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, authUser => React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, loading && React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, \"Loading ...\"), announcements ? React.createElement(AnnouncementList, {\n      authUser: authUser,\n      announcements: announcements,\n      onEditAnnouncement: this.onEditAnnouncement,\n      onRemoveAnnouncement: this.onRemoveAnnouncement,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }) : React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, \"There are no announcements...\"), React.createElement(\"form\", {\n      onSubmit: event => this.onCreateAnnouncement(event, authUser),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      value: title,\n      placeholder: \"Title\",\n      onChange: this.onChangeTitle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      type: \"text\",\n      value: text,\n      placeholder: \"Body\",\n      onChange: this.onChangeText,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      style: {\n        padding: \"3px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, \"Expiration Date: \"), React.createElement(DatePicker, {\n      selected: this.state.endDate,\n      onSelect: this.handleDateChange,\n      onChange: this.handleDateChange,\n      calendarAriaLabel: \"Expiration Date\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      type: \"submit\",\n      disabled: this.state.error || !this.state.endDate || !this.state.title || !this.state.text,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, \"Send\"), this.state.error && React.createElement(\"div\", {\n      style: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, \"Please enter a valid date.\"))));\n  }\n\n}\n\nconst AnnouncementList = ({\n  authUser,\n  announcements,\n  onRemoveAnnouncement,\n  onEditAnnouncement\n}) => React.createElement(\"ul\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 189\n  },\n  __self: this\n}, announcements.map(announcement => React.createElement(AnnouncementItem, {\n  authUser: authUser,\n  key: announcement.uid,\n  announcement: announcement,\n  onEditAnnouncement: onEditAnnouncement,\n  onRemoveAnnouncement: onRemoveAnnouncement,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 191\n  },\n  __self: this\n})));\n\nclass AnnouncementItem extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onToggleEditMode = () => {\n      this.setState(state => ({\n        editMode: !state.editMode,\n        editTitle: this.props.announcement.title,\n        editText: this.props.announcement.text,\n        editDate: this.props.announcement.endDate\n      }));\n    };\n\n    this.onChangeEditText = event => {\n      this.setState({\n        editText: event.target.value\n      });\n    };\n\n    this.onChangeEditTitle = event => {\n      this.setState({\n        editTitle: event.target.value\n      });\n    };\n\n    this.onChangeDate = event => {\n      if (Date.parse(event) > Date.now()) {\n        this.setState({\n          editDate: event,\n          error: false\n        });\n      } else {\n        this.setState({\n          error: true\n        });\n      }\n    };\n\n    this.onSaveEditText = () => {\n      this.props.onEditAnnouncement(this.props.announcement, this.state.editTitle, this.state.editText, this.state.editDate);\n      this.setState({\n        editMode: false\n      });\n    };\n\n    this.state = {\n      editMode: false,\n      editTitle: this.props.announcement.title,\n      editText: this.props.announcement.text,\n      editDate: this.props.announcement.endDate,\n      error: false\n    };\n  }\n\n  render() {\n    const _this$props = this.props,\n          authUser = _this$props.authUser,\n          announcement = _this$props.announcement,\n          onRemoveAnnouncement = _this$props.onRemoveAnnouncement;\n    const _this$state2 = this.state,\n          editMode = _this$state2.editMode,\n          editTitle = _this$state2.editTitle,\n          editText = _this$state2.editText;\n    return React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256\n      },\n      __self: this\n    }, editMode ? React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      value: editTitle,\n      onChange: this.onChangeEditTitle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      type: \"text\",\n      value: editText,\n      onChange: this.onChangeEditText,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264\n      },\n      __self: this\n    }), React.createElement(DatePicker, {\n      selected: this.state.editDate,\n      onSelect: this.onChangeDate,\n      onChange: this.onChangeDate,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 269\n      },\n      __self: this\n    })) : React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 276\n      },\n      __self: this\n    }, React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277\n      },\n      __self: this\n    }, announcement.title), \" \", announcement.text, \" (Posted by\", \" \", announcement.username, \")\", announcement.editedAt && React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279\n      },\n      __self: this\n    }, \" (Edited) \")), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282\n      },\n      __self: this\n    }, editMode ? React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      onClick: this.onSaveEditText,\n      disabled: this.state.error || !this.state.editDate || !this.state.editTitle || !this.state.editText,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285\n      },\n      __self: this\n    }, \"Save\"), React.createElement(\"button\", {\n      onClick: this.onToggleEditMode,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296\n      },\n      __self: this\n    }, \"Cancel\"), this.state.error && React.createElement(\"div\", {\n      style: {\n        color: \"red\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 298\n      },\n      __self: this\n    }, \"Please enter a valid date.\")) : React.createElement(\"button\", {\n      onClick: this.onToggleEditMode,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302\n      },\n      __self: this\n    }, \"Edit\"), !editMode && React.createElement(\"button\", {\n      type: \"button\",\n      onClick: () => onRemoveAnnouncement(announcement.uid),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 306\n      },\n      __self: this\n    }, \"Delete\")));\n  }\n\n}\n\nconst Announcements = withFirebase(AnnouncementsBase);\n\nconst condition = authUser => authUser && (!!authUser.roles[ROLES.MODERATOR] || !!authUser.roles[ROLES.ADMIN]);\n\nexport default compose(withAuthorization(condition), withFirebase)(ModeratorPage);","map":{"version":3,"sources":["C:\\Users\\moonl\\Documents\\GitHub\\Berryessa-App\\react\\src\\components\\Moderator\\index.js"],"names":["React","Component","Switch","Route","Link","compose","DatePicker","withFirebase","AuthUserContext","withAuthorization","withEmailVerification","ROLES","ROUTES","ModeratorPage","AnnouncementsBase","constructor","props","onChangeText","event","setState","text","target","value","onChangeTitle","title","handleDateChange","date","Date","parse","now","endDate","error","onCreateAnnouncement","authUser","dateHolder","state","firebase","announcements","push","userId","uid","createdAt","serverValue","TIMESTAMP","username","preventDefault","onRemoveAnnouncement","announcement","remove","onEditAnnouncement","announcementSnapshot","set","editedAt","loading","componentDidMount","on","snapshot","announcementObject","val","announcementList","Object","keys","map","key","filteredAnnouncements","filter","item","parseInt","componentWillUnmount","off","render","padding","color","AnnouncementList","AnnouncementItem","onToggleEditMode","editMode","editTitle","editText","editDate","onChangeEditText","onChangeEditTitle","onChangeDate","onSaveEditText","Announcements","condition","roles","MODERATOR","ADMIN"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { Switch, Route, Link } from \"react-router-dom\";\r\nimport { compose } from \"recompose\";\r\nimport DatePicker from \"react-datepicker\";\r\n\r\nimport { withFirebase } from \"../Firebase\";\r\nimport {\r\n  AuthUserContext,\r\n  withAuthorization,\r\n  withEmailVerification\r\n} from \"../Session\";\r\nimport * as ROLES from \"../../constants/roles\";\r\nimport * as ROUTES from \"../../constants/routes\";\r\nimport \"react-datepicker/dist/react-datepicker.css\";\r\n\r\nconst ModeratorPage = () => (\r\n  <div>\r\n    <h1>Moderator</h1>\r\n    <p>The Moderator Page is accessible by every signed in moderator user.</p>\r\n\r\n    <h2>Announcements</h2>\r\n    <Announcements />\r\n  </div>\r\n);\r\n\r\nclass AnnouncementsBase extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      title: \"\",\r\n      text: \"\",\r\n      endDate: \"\",\r\n      loading: false,\r\n      announcement: [],\r\n      error: false\r\n    };\r\n  }\r\n\r\n  onChangeText = event => {\r\n    this.setState({ text: event.target.value });\r\n  };\r\n\r\n  onChangeTitle = event => {\r\n    this.setState({ title: event.target.value });\r\n  };\r\n\r\n  handleDateChange = date => {\r\n    if (Date.parse(date) > Date.now()) {\r\n      this.setState({ endDate: date, error: false });\r\n    } else {\r\n      this.setState({ error: true });\r\n    }\r\n  };\r\n\r\n  onCreateAnnouncement = (event, authUser) => {\r\n    const dateHolder = Date.parse(this.state.endDate);\r\n\r\n    this.props.firebase.announcements().push({\r\n      title: this.state.title,\r\n      text: this.state.text,\r\n      endDate: dateHolder,\r\n      userId: authUser.uid,\r\n      createdAt: this.props.firebase.serverValue.TIMESTAMP,\r\n      username: authUser.username\r\n    });\r\n    this.setState({ title: \"\", text: \"\", endDate: \"\" });\r\n\r\n    event.preventDefault();\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.setState({ loading: true });\r\n\r\n    this.props.firebase.announcements().on(\"value\", snapshot => {\r\n      const announcementObject = snapshot.val();\r\n\r\n      if (announcementObject) {\r\n        const announcementList = Object.keys(announcementObject).map(key => ({\r\n          ...announcementObject[key],\r\n          uid: key\r\n        }));\r\n        const filteredAnnouncements = announcementList.filter(item => {\r\n          return parseInt(item.endDate) > Date.now();\r\n        });\r\n        this.setState({\r\n          announcements: filteredAnnouncements,\r\n          loading: false\r\n        });\r\n      } else {\r\n        this.setState({ announcements: null, loading: false });\r\n      }\r\n\r\n      this.setState({ loading: false });\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.props.firebase.announcements().off();\r\n  }\r\n\r\n  onRemoveAnnouncement = uid => {\r\n    this.props.firebase.announcement(uid).remove();\r\n  };\r\n\r\n  onEditAnnouncement = (announcement, title, text, dateHolder) => {\r\n    const { uid, ...announcementSnapshot } = announcement;\r\n    const endDate = Date.parse(dateHolder);\r\n\r\n    this.props.firebase.announcement(announcement.uid).set({\r\n      ...announcementSnapshot,\r\n      title,\r\n      text,\r\n      endDate,\r\n      editedAt: this.props.firebase.serverValue.TIMESTAMP\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const { title, text, endDate, announcements, loading } = this.state;\r\n\r\n    return (\r\n      <AuthUserContext.Consumer>\r\n        {authUser => (\r\n          <div>\r\n            {loading && <div>Loading ...</div>}\r\n\r\n            {announcements ? (\r\n              <AnnouncementList\r\n                authUser={authUser}\r\n                announcements={announcements}\r\n                onEditAnnouncement={this.onEditAnnouncement}\r\n                onRemoveAnnouncement={this.onRemoveAnnouncement}\r\n              />\r\n            ) : (\r\n              <div>There are no announcements...</div>\r\n            )}\r\n\r\n            <form\r\n              onSubmit={event => this.onCreateAnnouncement(event, authUser)}\r\n            >\r\n              <input\r\n                type=\"text\"\r\n                value={title}\r\n                placeholder=\"Title\"\r\n                onChange={this.onChangeTitle}\r\n              />\r\n              <input\r\n                type=\"text\"\r\n                value={text}\r\n                placeholder=\"Body\"\r\n                onChange={this.onChangeText}\r\n              />\r\n              <span style={{ padding: \"3px\" }}>Expiration Date: </span>\r\n              <DatePicker\r\n                selected={this.state.endDate}\r\n                onSelect={this.handleDateChange}\r\n                onChange={this.handleDateChange}\r\n                calendarAriaLabel=\"Expiration Date\"\r\n              />\r\n              <button\r\n                type=\"submit\"\r\n                disabled={\r\n                  this.state.error ||\r\n                  !this.state.endDate ||\r\n                  !this.state.title ||\r\n                  !this.state.text\r\n                }\r\n              >\r\n                Send\r\n              </button>\r\n              {this.state.error && (\r\n                <div style={{ color: \"red\" }}>Please enter a valid date.</div>\r\n              )}\r\n            </form>\r\n          </div>\r\n        )}\r\n      </AuthUserContext.Consumer>\r\n    );\r\n  }\r\n}\r\n\r\nconst AnnouncementList = ({\r\n  authUser,\r\n  announcements,\r\n  onRemoveAnnouncement,\r\n  onEditAnnouncement\r\n}) => (\r\n  <ul>\r\n    {announcements.map(announcement => (\r\n      <AnnouncementItem\r\n        authUser={authUser}\r\n        key={announcement.uid}\r\n        announcement={announcement}\r\n        onEditAnnouncement={onEditAnnouncement}\r\n        onRemoveAnnouncement={onRemoveAnnouncement}\r\n      />\r\n    ))}\r\n  </ul>\r\n);\r\n\r\nclass AnnouncementItem extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      editMode: false,\r\n      editTitle: this.props.announcement.title,\r\n      editText: this.props.announcement.text,\r\n      editDate: this.props.announcement.endDate,\r\n      error: false\r\n    };\r\n  }\r\n\r\n  onToggleEditMode = () => {\r\n    this.setState(state => ({\r\n      editMode: !state.editMode,\r\n      editTitle: this.props.announcement.title,\r\n      editText: this.props.announcement.text,\r\n      editDate: this.props.announcement.endDate\r\n    }));\r\n  };\r\n\r\n  onChangeEditText = event => {\r\n    this.setState({ editText: event.target.value });\r\n  };\r\n\r\n  onChangeEditTitle = event => {\r\n    this.setState({ editTitle: event.target.value });\r\n  };\r\n\r\n  onChangeDate = event => {\r\n    if (Date.parse(event) > Date.now()) {\r\n      this.setState({ editDate: event, error: false });\r\n    } else {\r\n      this.setState({ error: true });\r\n    }\r\n  };\r\n\r\n  onSaveEditText = () => {\r\n    this.props.onEditAnnouncement(\r\n      this.props.announcement,\r\n      this.state.editTitle,\r\n      this.state.editText,\r\n      this.state.editDate\r\n    );\r\n\r\n    this.setState({ editMode: false });\r\n  };\r\n\r\n  render() {\r\n    const { authUser, announcement, onRemoveAnnouncement } = this.props;\r\n    const { editMode, editTitle, editText } = this.state;\r\n\r\n    return (\r\n      <li>\r\n        {editMode ? (\r\n          <React.Fragment>\r\n            <input\r\n              type=\"text\"\r\n              value={editTitle}\r\n              onChange={this.onChangeEditTitle}\r\n            />\r\n            <input\r\n              type=\"text\"\r\n              value={editText}\r\n              onChange={this.onChangeEditText}\r\n            />\r\n            <DatePicker\r\n              selected={this.state.editDate}\r\n              onSelect={this.onChangeDate}\r\n              onChange={this.onChangeDate}\r\n            />\r\n          </React.Fragment>\r\n        ) : (\r\n          <span>\r\n            <strong>{announcement.title}</strong> {announcement.text} (Posted by{\" \"}\r\n            {announcement.username})\r\n            {announcement.editedAt && <span> (Edited) </span>}\r\n          </span>\r\n        )}\r\n        <span>\r\n          {editMode ? (\r\n            <span>\r\n              <button\r\n                onClick={this.onSaveEditText}\r\n                disabled={\r\n                  this.state.error ||\r\n                  !this.state.editDate ||\r\n                  !this.state.editTitle ||\r\n                  !this.state.editText\r\n                }\r\n              >\r\n                Save\r\n              </button>\r\n              <button onClick={this.onToggleEditMode}>Cancel</button>\r\n              {this.state.error && (\r\n                <div style={{ color: \"red\" }}>Please enter a valid date.</div>\r\n              )}\r\n            </span>\r\n          ) : (\r\n            <button onClick={this.onToggleEditMode}>Edit</button>\r\n          )}\r\n\r\n          {!editMode && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => onRemoveAnnouncement(announcement.uid)}\r\n            >\r\n              Delete\r\n            </button>\r\n          )}\r\n        </span>\r\n      </li>\r\n    );\r\n  }\r\n}\r\n\r\nconst Announcements = withFirebase(AnnouncementsBase);\r\n\r\nconst condition = authUser =>\r\n  authUser &&\r\n  (!!authUser.roles[ROLES.MODERATOR] || !!authUser.roles[ROLES.ADMIN]);\r\n\r\nexport default compose(\r\n  withAuthorization(condition),\r\n  withFirebase\r\n)(ModeratorPage);\r\n"]},"metadata":{},"sourceType":"module"}